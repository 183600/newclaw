
> openclaw@2026.2.2 test /home/runner/work/newclaw/newclaw
> node scripts/test-parallel.mjs


[1m[46m RUN [49m[22m [36mv4.0.18 [39m[90m/home/runner/work/newclaw/newclaw[39m


[1m[46m RUN [49m[22m [36mv4.0.18 [39m[90m/home/runner/work/newclaw/newclaw[39m

 [32mâœ“[39m src/config/config.nix-integration-u3-u5-u9.test.ts [2m([22m[2m17 tests[22m[2m)[22m[33m 20435[2mms[22m[39m
       [33m[2mâœ“[22m[39m isNixMode is false when OPENCLAW_NIX_MODE is not set [33m 1286[2mms[22m[39m
       [33m[2mâœ“[22m[39m isNixMode is false when OPENCLAW_NIX_MODE is empty [33m 1417[2mms[22m[39m
       [33m[2mâœ“[22m[39m isNixMode is false when OPENCLAW_NIX_MODE is not '1' [33m 1177[2mms[22m[39m
       [33m[2mâœ“[22m[39m isNixMode is true when OPENCLAW_NIX_MODE=1 [33m 996[2mms[22m[39m
       [33m[2mâœ“[22m[39m STATE_DIR defaults to ~/.openclaw when env not set [33m 1270[2mms[22m[39m
       [33m[2mâœ“[22m[39m STATE_DIR respects OPENCLAW_STATE_DIR override [33m 1142[2mms[22m[39m
       [33m[2mâœ“[22m[39m CONFIG_PATH defaults to ~/.openclaw/openclaw.json when env not set [33m 913[2mms[22m[39m
       [33m[2mâœ“[22m[39m CONFIG_PATH respects OPENCLAW_CONFIG_PATH override [33m 1102[2mms[22m[39m
       [33m[2mâœ“[22m[39m CONFIG_PATH expands ~ in OPENCLAW_CONFIG_PATH override [33m 1159[2mms[22m[39m
       [33m[2mâœ“[22m[39m CONFIG_PATH uses STATE_DIR when only state dir is overridden [33m 1108[2mms[22m[39m
       [33m[2mâœ“[22m[39m expands ~ in common path-ish config fields [33m 2160[2mms[22m[39m
       [33m[2mâœ“[22m[39m uses default when env and config are unset [33m 1257[2mms[22m[39m
       [33m[2mâœ“[22m[39m prefers OPENCLAW_GATEWAY_PORT over config [33m 988[2mms[22m[39m
       [33m[2mâœ“[22m[39m falls back to config when env is invalid [33m 1042[2mms[22m[39m
       [33m[2mâœ“[22m[39m accepts config with only botToken [33m 1179[2mms[22m[39m
       [33m[2mâœ“[22m[39m accepts config with only tokenFile [33m 982[2mms[22m[39m
       [33m[2mâœ“[22m[39m accepts config with both botToken and tokenFile [33m 1234[2mms[22m[39m
 [32mâœ“[39m extensions/memory-lancedb/index.test.ts [2m([22m[2m7 tests[22m[2m | [22m[33m2 skipped[39m[2m)[22m[33m 49533[2mms[22m[39m
     [33m[2mâœ“[22m[39m config schema parses valid config [33m 49450[2mms[22m[39m
 [32mâœ“[39m extensions/twitch/src/onboarding.test.ts [2m([22m[2m15 tests[22m[2m)[22m[33m 49587[2mms[22m[39m
       [33m[2mâœ“[22m[39m should return existing token when user confirms to keep it [33m 49480[2mms[22m[39m
[90mstderr[2m | src/agents/pi-embedded-runner.run-embedded-pi-agent.auth-profile-rotation.test.ts[2m > [22m[2mrunEmbeddedPiAgent auth profile rotation[2m > [22m[2mrotates for auto-pinned profiles
[22m[39m[33m[agent/embedded][39m [33mlow context window: openai/mock-1 ctx=16000 (warn<32000) source=modelsConfig[39m

[90mstderr[2m | src/agents/pi-embedded-runner.run-embedded-pi-agent.auth-profile-rotation.test.ts[2m > [22m[2mrunEmbeddedPiAgent auth profile rotation[2m > [22m[2mdoes not rotate for user-pinned profiles
[22m[39m[33m[agent/embedded][39m [33mlow context window: openai/mock-1 ctx=16000 (warn<32000) source=modelsConfig[39m

 [32mâœ“[39m extensions/nostr/src/nostr-profile.fuzz.test.ts [2m([22m[2m51 tests[22m[2m)[22m[33m 4066[2mms[22m[39m
     [33m[2mâœ“[22m[39m handles profile with all fields at max length [33m 489[2mms[22m[39m
     [33m[2mâœ“[22m[39m handles rapid sequential events with monotonic timestamps [33m 3367[2mms[22m[39m
[90mstderr[2m | src/agents/pi-embedded-runner.run-embedded-pi-agent.auth-profile-rotation.test.ts[2m > [22m[2mrunEmbeddedPiAgent auth profile rotation[2m > [22m[2mhonors user-pinned profiles even when in cooldown
[22m[39m[33m[agent/embedded][39m [33mlow context window: openai/mock-1 ctx=16000 (warn<32000) source=modelsConfig[39m

[90mstderr[2m | src/agents/pi-embedded-runner.run-embedded-pi-agent.auth-profile-rotation.test.ts[2m > [22m[2mrunEmbeddedPiAgent auth profile rotation[2m > [22m[2mignores user-locked profile when provider mismatches
[22m[39m[33m[agent/embedded][39m [33mlow context window: openai/mock-1 ctx=16000 (warn<32000) source=modelsConfig[39m

[90mstderr[2m | src/agents/pi-embedded-runner.run-embedded-pi-agent.auth-profile-rotation.test.ts[2m > [22m[2mrunEmbeddedPiAgent auth profile rotation[2m > [22m[2mskips profiles in cooldown during initial selection
[22m[39m[33m[agent/embedded][39m [33mlow context window: openai/mock-1 ctx=16000 (warn<32000) source=modelsConfig[39m

[90mstderr[2m | src/agents/pi-embedded-runner.run-embedded-pi-agent.auth-profile-rotation.test.ts[2m > [22m[2mrunEmbeddedPiAgent auth profile rotation[2m > [22m[2mfails over when all profiles are in cooldown and fallbacks are configured
[22m[39m[33m[agent/embedded][39m [33mlow context window: openai/mock-1 ctx=16000 (warn<32000) source=modelsConfig[39m

[90mstderr[2m | src/agents/pi-embedded-runner.run-embedded-pi-agent.auth-profile-rotation.test.ts[2m > [22m[2mrunEmbeddedPiAgent auth profile rotation[2m > [22m[2mfails over when all profiles are in cooldown and fallbacks are configured
[22m[39m[31m[diagnostic][39m [31mlane task error: lane=main durationMs=0 error="FailoverError: No available auth profile for openai (all in cooldown or unavailable)."[39m

[90mstderr[2m | src/agents/pi-embedded-runner.run-embedded-pi-agent.auth-profile-rotation.test.ts[2m > [22m[2mrunEmbeddedPiAgent auth profile rotation[2m > [22m[2mfails over when all profiles are in cooldown and fallbacks are configured
[22m[39m[31m[diagnostic][39m [31mlane task error: lane=session:agent:test:cooldown-failover durationMs=0 error="FailoverError: No available auth profile for openai (all in cooldown or unavailable)."[39m

[90mstderr[2m | src/agents/pi-embedded-runner.run-embedded-pi-agent.auth-profile-rotation.test.ts[2m > [22m[2mrunEmbeddedPiAgent auth profile rotation[2m > [22m[2mfails over when auth is unavailable and fallbacks are configured
[22m[39m[33m[agent/embedded][39m [33mlow context window: openai/mock-1 ctx=16000 (warn<32000) source=modelsConfig[39m

[90mstderr[2m | src/agents/pi-embedded-runner.run-embedded-pi-agent.auth-profile-rotation.test.ts[2m > [22m[2mrunEmbeddedPiAgent auth profile rotation[2m > [22m[2mfails over when auth is unavailable and fallbacks are configured
[22m[39m[31m[diagnostic][39m [31mlane task error: lane=main durationMs=230 error="FailoverError: No API key found for provider "openai". Auth store: /tmp/openclaw-agent-1n1Qla/auth-profiles.json (agentDir: /tmp/openclaw-agent-1n1Qla). Configure auth for this agent (openclaw agents add <id>) or copy auth-profiles.json from the main agentDir."[39m

[90mstderr[2m | src/agents/pi-embedded-runner.run-embedded-pi-agent.auth-profile-rotation.test.ts[2m > [22m[2mrunEmbeddedPiAgent auth profile rotation[2m > [22m[2mfails over when auth is unavailable and fallbacks are configured
[22m[39m[31m[diagnostic][39m [31mlane task error: lane=session:agent:test:auth-unavailable durationMs=256 error="FailoverError: No API key found for provider "openai". Auth store: /tmp/openclaw-agent-1n1Qla/auth-profiles.json (agentDir: /tmp/openclaw-agent-1n1Qla). Configure auth for this agent (openclaw agents add <id>) or copy auth-profiles.json from the main agentDir."[39m

[90mstderr[2m | src/agents/pi-embedded-runner.run-embedded-pi-agent.auth-profile-rotation.test.ts[2m > [22m[2mrunEmbeddedPiAgent auth profile rotation[2m > [22m[2mskips profiles in cooldown when rotating after failure
[22m[39m[33m[agent/embedded][39m [33mlow context window: openai/mock-1 ctx=16000 (warn<32000) source=modelsConfig[39m

 [32mâœ“[39m src/agents/pi-embedded-runner.run-embedded-pi-agent.auth-profile-rotation.test.ts [2m([22m[2m8 tests[22m[2m)[22m[33m 53445[2mms[22m[39m
     [33m[2mâœ“[22m[39m rotates for auto-pinned profiles [33m 696[2mms[22m[39m
     [33m[2mâœ“[22m[39m does not rotate for user-pinned profiles [33m 432[2mms[22m[39m
     [33m[2mâœ“[22m[39m honors user-pinned profiles even when in cooldown [33m 363[2mms[22m[39m
     [33m[2mâœ“[22m[39m ignores user-locked profile when provider mismatches [33m 417[2mms[22m[39m
     [33m[2mâœ“[22m[39m skips profiles in cooldown during initial selection [33m 406[2mms[22m[39m
     [33m[2mâœ“[22m[39m fails over when all profiles are in cooldown and fallbacks are configured [33m 374[2mms[22m[39m
     [33m[2mâœ“[22m[39m fails over when auth is unavailable and fallbacks are configured [32m 300[2mms[22m[39m
     [33m[2mâœ“[22m[39m skips profiles in cooldown when rotating after failure [33m 326[2mms[22m[39m
 [32mâœ“[39m extensions/lobster/src/lobster-tool.test.ts [2m([22m[2m9 tests[22m[2m)[22m[33m 1115[2mms[22m[39m
     [33m[2mâœ“[22m[39m runs lobster and returns parsed envelope in details [33m 336[2mms[22m[39m
 [32mâœ“[39m src/cli/gateway-cli.coverage.test.ts [2m([22m[2m9 tests[22m[2m)[22m[33m 28594[2mms[22m[39m
     [33m[2mâœ“[22m[39m registers call/health commands and routes to callGateway [33m 23583[2mms[22m[39m
     [33m[2mâœ“[22m[39m prints stop hints on GatewayLockError when service is loaded [33m 438[2mms[22m[39m
     [33m[2mâœ“[22m[39m uses env/config port when --port is omitted [33m 4390[2mms[22m[39m
 [32mâœ“[39m extensions/matrix/src/matrix/send.test.ts [2m([22m[2m3 tests[22m[2m)[22m[33m 797[2mms[22m[39m
[90mstderr[2m | extensions/bluebubbles/src/monitor.test.ts[2m > [22m[2mBlueBubbles webhook monitor[2m > [22m[2mwebhook parsing + auth handling[2m > [22m[2mrejects requests with invalid JSON
[22m[39m[bluebubbles] webhook rejected: invalid json

[90mstderr[2m | extensions/bluebubbles/src/monitor.test.ts[2m > [22m[2mBlueBubbles webhook monitor[2m > [22m[2mwebhook parsing + auth handling[2m > [22m[2mrejects unauthorized requests with wrong password
[22m[39m[bluebubbles] webhook rejected: unauthorized guid=wr***en

 [32mâœ“[39m extensions/bluebubbles/src/monitor.test.ts [2m([22m[2m50 tests[22m[2m)[22m[33m 1163[2mms[22m[39m
 [32mâœ“[39m src/commands/onboard-non-interactive.gateway.test.ts [2m([22m[2m3 tests[22m[2m)[22m[33m 21704[2mms[22m[39m
     [33m[2mâœ“[22m[39m writes gateway token auth into config and gateway enforces it [33m 17417[2mms[22m[39m
     [33m[2mâœ“[22m[39m auto-generates token auth when binding LAN and persists the token [33m 4079[2mms[22m[39m
 [32mâœ“[39m extensions/nostr/src/nostr-profile.test.ts [2m([22m[2m31 tests[22m[2m)[22m[33m 698[2mms[22m[39m
 [32mâœ“[39m extensions/llm-task/src/llm-task-tool.test.ts [2m([22m[2m8 tests[22m[2m)[22m[33m 531[2mms[22m[39m
 [32mâœ“[39m extensions/nostr/src/types.test.ts [2m([22m[2m12 tests[22m[2m)[22m[33m 450[2mms[22m[39m
     [33m[2mâœ“[22m[39m resolves configured account [33m 358[2mms[22m[39m
 [32mâœ“[39m extensions/msteams/src/attachments.test.ts [2m([22m[2m19 tests[22m[2m)[22m[33m 443[2mms[22m[39m
 [32mâœ“[39m src/config/config.legacy-config-detection.rejects-routing-allowfrom.test.ts [2m([22m[2m30 tests[22m[2m)[22m[33m 29980[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects routing.allowFrom [33m 958[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects routing.groupChat.requireMention [33m 1311[2mms[22m[39m
     [33m[2mâœ“[22m[39m migrates routing.allowFrom to channels.whatsapp.allowFrom when whatsapp configured [33m 1335[2mms[22m[39m
     [33m[2mâœ“[22m[39m drops routing.allowFrom when whatsapp missing [33m 1357[2mms[22m[39m
     [33m[2mâœ“[22m[39m migrates routing.groupChat.requireMention to channels whatsapp/telegram/imessage groups when whatsapp configured [33m 1351[2mms[22m[39m
     [33m[2mâœ“[22m[39m migrates routing.groupChat.requireMention to telegram/imessage when whatsapp missing [33m 1345[2mms[22m[39m
     [33m[2mâœ“[22m[39m migrates routing.groupChat.mentionPatterns to messages.groupChat.mentionPatterns [33m 1116[2mms[22m[39m
     [33m[2mâœ“[22m[39m migrates routing agentToAgent/queue/transcribeAudio to tools/messages/media [33m 1126[2mms[22m[39m
     [33m[2mâœ“[22m[39m migrates agent config into agents.defaults and tools [33m 1270[2mms[22m[39m
     [33m[2mâœ“[22m[39m migrates tools.bash to tools.exec [33m 1119[2mms[22m[39m
     [33m[2mâœ“[22m[39m accepts per-agent tools.elevated overrides [33m 1124[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects telegram.requireMention [33m 1203[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects gateway.token [33m 620[2mms[22m[39m
     [33m[2mâœ“[22m[39m migrates gateway.token to gateway.auth.token [33m 956[2mms[22m[39m
     [33m[2mâœ“[22m[39m keeps gateway.bind tailnet [33m 852[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects telegram.dmPolicy="open" without allowFrom "*" [33m 775[2mms[22m[39m
     [33m[2mâœ“[22m[39m accepts telegram.dmPolicy="open" with allowFrom "*" [33m 773[2mms[22m[39m
     [33m[2mâœ“[22m[39m defaults telegram.dmPolicy to pairing when telegram section exists [33m 966[2mms[22m[39m
     [33m[2mâœ“[22m[39m defaults telegram.groupPolicy to allowlist when telegram section exists [33m 839[2mms[22m[39m
     [33m[2mâœ“[22m[39m defaults telegram.streamMode to partial when telegram section exists [33m 1071[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects whatsapp.dmPolicy="open" without allowFrom "*" [33m 843[2mms[22m[39m
     [33m[2mâœ“[22m[39m accepts whatsapp.dmPolicy="open" with allowFrom "*" [33m 896[2mms[22m[39m
     [33m[2mâœ“[22m[39m defaults whatsapp.dmPolicy to pairing when whatsapp section exists [33m 787[2mms[22m[39m
     [33m[2mâœ“[22m[39m defaults whatsapp.groupPolicy to allowlist when whatsapp section exists [33m 820[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects signal.dmPolicy="open" without allowFrom "*" [33m 871[2mms[22m[39m
     [33m[2mâœ“[22m[39m accepts signal.dmPolicy="open" with allowFrom "*" [33m 818[2mms[22m[39m
     [33m[2mâœ“[22m[39m defaults signal.dmPolicy to pairing when signal section exists [33m 892[2mms[22m[39m
     [33m[2mâœ“[22m[39m defaults signal.groupPolicy to allowlist when signal section exists [33m 794[2mms[22m[39m
     [33m[2mâœ“[22m[39m accepts historyLimit overrides per provider and account [33m 842[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects imessage.dmPolicy="open" without allowFrom "*" [33m 933[2mms[22m[39m
 [32mâœ“[39m extensions/zalo/src/monitor.webhook.test.ts [2m([22m[2m1 test[22m[2m)[22m[33m 376[2mms[22m[39m
     [33m[2mâœ“[22m[39m returns 400 for non-object payloads [33m 370[2mms[22m[39m
[90mstdout[2m | src/telegram/bot.media.downloads-media-file-path-no-file-download.test.ts[2m > [22m[2mtelegram inbound media[2m > [22m[2mdownloads media via file_path (no file.download)
[22m[39m[34m[telegram][39m [36mautoSelectFamily=false (default-node22)[39m

 [32mâœ“[39m extensions/twitch/src/probe.test.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 180[2mms[22m[39m
 [32mâœ“[39m extensions/nostr/src/nostr-bus.test.ts [2m([22m[2m32 tests[22m[2m)[22m[33m 553[2mms[22m[39m
     [33m[2mâœ“[22m[39m derives public key from hex private key [33m 379[2mms[22m[39m
 [32mâœ“[39m extensions/nostr/src/nostr-bus.fuzz.test.ts [2m([22m[2m76 tests[22m[2m)[22m[33m 396[2mms[22m[39m
 [32mâœ“[39m src/telegram/bot.media.downloads-media-file-path-no-file-download.test.ts [2m([22m[2m10 tests[22m[2m)[22m[33m 23096[2mms[22m[39m
     [33m[2mâœ“[22m[39m downloads media via file_path (no file.download) [33m 17332[2mms[22m[39m
     [33m[2mâœ“[22m[39m prefers proxyFetch over global fetch [33m 739[2mms[22m[39m
     [33m[2mâœ“[22m[39m logs a handler error when getFile returns no file_path [33m 708[2mms[22m[39m
     [33m[2mâœ“[22m[39m buffers messages with same media_group_id and processes them together [33m 698[2mms[22m[39m
     [33m[2mâœ“[22m[39m processes separate media groups independently [33m 561[2mms[22m[39m
     [33m[2mâœ“[22m[39m downloads static sticker (WEBP) and includes sticker metadata [33m 677[2mms[22m[39m
     [33m[2mâœ“[22m[39m refreshes cached sticker metadata on cache hit [33m 577[2mms[22m[39m
     [33m[2mâœ“[22m[39m skips animated stickers (TGS format) [33m 652[2mms[22m[39m
     [33m[2mâœ“[22m[39m skips video stickers (WEBM format) [33m 554[2mms[22m[39m
     [33m[2mâœ“[22m[39m buffers near-limit text and processes sequential parts as one message [33m 579[2mms[22m[39m
 [32mâœ“[39m extensions/bluebubbles/src/send.test.ts [2m([22m[2m30 tests[22m[2m)[22m[32m 238[2mms[22m[39m
 [32mâœ“[39m extensions/bluebubbles/src/reactions.test.ts [2m([22m[2m46 tests[22m[2m)[22m[32m 180[2mms[22m[39m
[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mcompresses common formats to jpeg under the cap
[22m[39m[35m[whatsapp][39m [36mListening for personal WhatsApp inbound messages.[39m

[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mcompresses common formats to jpeg under the cap
[22m[39m[35m[whatsapp][39m [36mInbound message +1 -> +2 (undefined, 30 chars)[39m

[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mcompresses common formats to jpeg under the cap
[22m[39m[35m[whatsapp][39m [36mSent media reply to +1 (0.74MB)[39m

[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mcompresses common formats to jpeg under the cap
[22m[39m[35m[whatsapp][39m [36mAuto-replied to +1 (media)[39m

[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mcompresses common formats to jpeg under the cap
[22m[39m[35m[whatsapp][39m [36mListening for personal WhatsApp inbound messages.[39m

[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mcompresses common formats to jpeg under the cap
[22m[39m[35m[whatsapp][39m [36mInbound message +1 -> +2 (undefined, 30 chars)[39m

 [32mâœ“[39m extensions/twitch/src/twitch-client.test.ts [2m([22m[2m30 tests[22m[2m)[22m[32m 265[2mms[22m[39m
 [32mâœ“[39m extensions/google-gemini-cli-auth/oauth.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 216[2mms[22m[39m
[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mcompresses common formats to jpeg under the cap
[22m[39m[35m[whatsapp][39m [36mSent media reply to +1 (0.69MB)[39m

[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mcompresses common formats to jpeg under the cap
[22m[39m[35m[whatsapp][39m [36mAuto-replied to +1 (media)[39m

[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mcompresses common formats to jpeg under the cap
[22m[39m[35m[whatsapp][39m [36mListening for personal WhatsApp inbound messages.[39m

[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mcompresses common formats to jpeg under the cap
[22m[39m[35m[whatsapp][39m [36mInbound message +1 -> +2 (undefined, 30 chars)[39m

 [32mâœ“[39m extensions/bluebubbles/src/actions.test.ts [2m([22m[2m27 tests[22m[2m)[22m[33m 336[2mms[22m[39m
 [32mâœ“[39m extensions/twitch/src/outbound.test.ts [2m([22m[2m21 tests[22m[2m)[22m[32m 190[2mms[22m[39m
 [32mâœ“[39m extensions/bluebubbles/src/chat.test.ts [2m([22m[2m31 tests[22m[2m)[22m[32m 262[2mms[22m[39m
 [32mâœ“[39m src/signal/monitor.event-handler.typing-read-receipts.test.ts [2m([22m[2m1 test[22m[2m)[22m[33m 22363[2mms[22m[39m
     [33m[2mâœ“[22m[39m sends typing + read receipt for allowed DMs [33m 22360[2mms[22m[39m
[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mcompresses common formats to jpeg under the cap
[22m[39m[35m[whatsapp][39m [36mSent media reply to +1 (0.69MB)[39m

[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mcompresses common formats to jpeg under the cap
[22m[39m[35m[whatsapp][39m [36mAuto-replied to +1 (media)[39m

[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mhonors mediaMaxMb from config
[22m[39m[35m[whatsapp][39m [36mListening for personal WhatsApp inbound messages.[39m

[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mhonors mediaMaxMb from config
[22m[39m[35m[whatsapp][39m [36mInbound message +1 -> +2 (undefined, 30 chars)[39m

[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mhonors mediaMaxMb from config
[22m[39m[35m[whatsapp][39m [36mSent media reply to +1 (0.01MB)[39m

[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mhonors mediaMaxMb from config
[22m[39m[35m[whatsapp][39m [36mAuto-replied to +1 (media)[39m

[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mfalls back to text when media is unsupported
[22m[39m[35m[whatsapp][39m [36mListening for personal WhatsApp inbound messages.[39m

[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mfalls back to text when media is unsupported
[22m[39m[35m[whatsapp][39m [36mInbound message +1 -> +2 (undefined, 19 chars)[39m

[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mfalls back to text when media is unsupported
[22m[39m[35m[whatsapp][39m [36mSent media reply to +1 (0.01MB)[39m

[90mstdout[2m | src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts[2m > [22m[2mweb auto-reply[2m > [22m[2mfalls back to text when media is unsupported
[22m[39m[35m[whatsapp][39m [36mAuto-replied to +1 (media)[39m

 [32mâœ“[39m src/web/auto-reply.web-auto-reply.compresses-common-formats-jpeg-cap.test.ts [2m([22m[2m3 tests[22m[2m)[22m[33m 28778[2mms[22m[39m
     [33m[2mâœ“[22m[39m compresses common formats to jpeg under the cap [33m 25654[2mms[22m[39m
     [33m[2mâœ“[22m[39m honors mediaMaxMb from config [33m 2969[2mms[22m[39m
 [32mâœ“[39m extensions/msteams/src/polls.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 128[2mms[22m[39m
 [32mâœ“[39m extensions/msteams/src/conversation-store-fs.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 149[2mms[22m[39m
 [32mâœ“[39m extensions/bluebubbles/src/attachments.test.ts [2m([22m[2m18 tests[22m[2m)[22m[32m 265[2mms[22m[39m
[90mstderr[2m | extensions/voice-call/src/webhook-security.test.ts[2m > [22m[2mverifyTwilioWebhook[2m > [22m[2mallows invalid signatures for ngrok free tier only on loopback
[22m[39m[voice-call] Twilio signature validation failed (ngrok free tier compatibility, loopback only)

 [32mâœ“[39m extensions/voice-call/src/webhook-security.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 203[2mms[22m[39m
[90mstderr[2m | src/agents/pi-embedded-runner.test.ts[2m > [22m[2mrunEmbeddedPiAgent[2m > [22m[2mpersists the first user message before assistant output
[22m[39m[33m[agent/embedded][39m [33mlow context window: openai/mock-1 ctx=16000 (warn<32000) source=modelsConfig[39m

[90mstderr[2m | src/agents/pi-embedded-runner.test.ts[2m > [22m[2mrunEmbeddedPiAgent[2m > [22m[2mpersists the user message when prompt fails before assistant output
[22m[39m[33m[agent/embedded][39m [33mlow context window: openai/mock-error ctx=16000 (warn<32000) source=modelsConfig[39m

 [32mâœ“[39m extensions/nostr/src/nostr-profile-http.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 228[2mms[22m[39m
 [32mâœ“[39m extensions/nostr/src/nostr-bus.integration.test.ts [2m([22m[2m26 tests[22m[2m)[22m[32m 217[2mms[22m[39m
[90mstderr[2m | src/agents/pi-embedded-runner.test.ts[2m > [22m[2mrunEmbeddedPiAgent[2m > [22m[2mappends new user + assistant after existing transcript entries
[22m[39m[33m[agent/embedded][39m [33mlow context window: openai/mock-1 ctx=16000 (warn<32000) source=modelsConfig[39m

[90mstdout[2m | extensions/voice-call/src/manager.test.ts[2m > [22m[2mCallManager[2m > [22m[2mupgrades providerCallId mapping when provider ID changes
[22m[39m[voice-call] Starting max duration timer (300s) for call 14d13152-2098-4361-bf21-5845b22e1f3e

[90mstdout[2m | extensions/voice-call/src/manager.test.ts[2m > [22m[2mCallManager[2m > [22m[2mspeaks initial message on answered for notify mode (non-Twilio)
[22m[39m[voice-call] Using inline TwiML for notify mode (voice: Polly.Joanna)

[90mstdout[2m | extensions/voice-call/src/manager.test.ts[2m > [22m[2mCallManager[2m > [22m[2mspeaks initial message on answered for notify mode (non-Twilio)
[22m[39m[voice-call] Starting max duration timer (300s) for call 8a9014d5-e97a-4ae6-9ca0-029aef487fe0
[voice-call] Speaking initial message for call 8a9014d5-e97a-4ae6-9ca0-029aef487fe0 (mode: notify)

[90mstdout[2m | extensions/voice-call/src/manager.test.ts[2m > [22m[2mCallManager[2m > [22m[2mspeaks initial message on answered for notify mode (non-Twilio)
[22m[39m[voice-call] Notify mode: auto-hangup in 3s for call 8a9014d5-e97a-4ae6-9ca0-029aef487fe0

[90mstdout[2m | extensions/voice-call/src/manager.test.ts[2m > [22m[2mCallManager[2m > [22m[2mrejects inbound calls with missing caller ID when allowlist enabled
[22m[39m[voice-call] Inbound call rejected: missing caller ID

[90mstdout[2m | extensions/voice-call/src/manager.test.ts[2m > [22m[2mCallManager[2m > [22m[2mrejects inbound calls that only match allowlist suffixes
[22m[39m[voice-call] Inbound call rejected: +99915550001234 not in allowlist

[90mstdout[2m | extensions/voice-call/src/manager.test.ts[2m > [22m[2mCallManager[2m > [22m[2maccepts inbound calls that exactly match the allowlist
[22m[39m[voice-call] Inbound call accepted: +15550001234 is in allowlist
[voice-call] Created inbound call record: 5c136d11-0be8-491d-bfa0-cd5908d89d60 from +15550001234

 [32mâœ“[39m extensions/voice-call/src/manager.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 180[2mms[22m[39m
[90mstderr[2m | src/agents/pi-embedded-runner.test.ts[2m > [22m[2mrunEmbeddedPiAgent[2m > [22m[2mpersists multi-turn user/assistant ordering across runs
[22m[39m[33m[agent/embedded][39m [33mlow context window: openai/mock-1 ctx=16000 (warn<32000) source=modelsConfig[39m

[90mstderr[2m | src/agents/pi-embedded-runner.test.ts[2m > [22m[2mrunEmbeddedPiAgent[2m > [22m[2mpersists multi-turn user/assistant ordering across runs
[22m[39m[33m[agent/embedded][39m [33mlow context window: openai/mock-1 ctx=16000 (warn<32000) source=modelsConfig[39m

[90mstderr[2m | src/agents/pi-embedded-runner.test.ts[2m > [22m[2mrunEmbeddedPiAgent[2m > [22m[2mrepairs orphaned user messages and continues
[22m[39m[33m[agent/embedded][39m [33mlow context window: openai/mock-1 ctx=16000 (warn<32000) source=modelsConfig[39m

Usage: program models auth [options] [command]

Manage model auth profiles

Options:
  --agent <id>                    Agent id for auth order get/set/clear
  -h, --help                      display help for command

Commands:
  add                             Interactive auth helper (setup-token or paste
                                  token)
  login [options]                 Run a provider plugin auth flow (OAuth/API
                                  key)
  setup-token [options]           Run a provider CLI to create/sync a token (TTY
                                  required)
  paste-token [options]           Paste a token into auth-profiles.json and
                                  update config
  login-github-copilot [options]  Login to GitHub Copilot via GitHub device flow
                                  (TTY required)
  order                           Manage per-agent auth profile order overrides
 [32mâœ“[39m src/cli/models-cli.test.ts [2m([22m[2m4 tests[22m[2m)[22m[33m 24231[2mms[22m[39m
     [33m[2mâœ“[22m[39m registers github-copilot login command [33m 24148[2mms[22m[39m
[90mstderr[2m | src/agents/pi-embedded-runner.test.ts[2m > [22m[2mrunEmbeddedPiAgent[2m > [22m[2mrepairs orphaned single-user sessions and continues
[22m[39m[33m[agent/embedded][39m [33mlow context window: openai/mock-1 ctx=16000 (warn<32000) source=modelsConfig[39m

 [32mâœ“[39m src/agents/pi-embedded-runner.test.ts [2m([22m[2m7 tests[22m[2m)[22m[33m 22035[2mms[22m[39m
     [33m[2mâœ“[22m[39m writes models.json into the provided agentDir [33m 421[2mms[22m[39m
     [33m[2mâœ“[22m[39m persists the first user message before assistant output [33m 2969[2mms[22m[39m
     [33m[2mâœ“[22m[39m persists the user message when prompt fails before assistant output [33m 1257[2mms[22m[39m
     [33m[2mâœ“[22m[39m appends new user + assistant after existing transcript entries [33m 1295[2mms[22m[39m
     [33m[2mâœ“[22m[39m persists multi-turn user/assistant ordering across runs [33m 2275[2mms[22m[39m
     [33m[2mâœ“[22m[39m repairs orphaned user messages and continues [33m 1135[2mms[22m[39m
     [33m[2mâœ“[22m[39m repairs orphaned single-user sessions and continues [33m 1139[2mms[22m[39m
 [32mâœ“[39m extensions/tlon/src/urbit/send.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 142[2mms[22m[39m
 [32mâœ“[39m extensions/twitch/src/send.test.ts [2m([22m[2m9 tests[22m[2m)[22m[32m 138[2mms[22m[39m
 [32mâœ“[39m extensions/twitch/src/access-control.test.ts [2m([22m[2m31 tests[22m[2m)[22m[32m 114[2mms[22m[39m
 [32mâœ“[39m extensions/msteams/src/file-consent-helpers.test.ts [2m([22m[2m16 tests[22m[2m)[22m[32m 34[2mms[22m[39m
 [32mâœ“[39m extensions/msteams/src/media-helpers.test.ts [2m([22m[2m36 tests[22m[2m)[22m[32m 169[2mms[22m[39m
 [32mâœ“[39m extensions/zalouser/src/status-issues.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 88[2mms[22m[39m
 [32mâœ“[39m src/commands/onboard-non-interactive.ai-gateway.test.ts [2m([22m[2m1 test[22m[2m)[22m[33m 25185[2mms[22m[39m
     [33m[2mâœ“[22m[39m stores the API key and configures the default model [33m 25183[2mms[22m[39m
 [32mâœ“[39m src/plugins/install.test.ts [2m([22m[2m7 tests[22m[2m)[22m[33m 24690[2mms[22m[39m
     [33m[2mâœ“[22m[39m installs into ~/.openclaw/extensions and uses unscoped id [33m 3626[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects installing when plugin already exists [33m 4202[2mms[22m[39m
     [33m[2mâœ“[22m[39m allows updates when mode is update [33m 6550[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects traversal-like plugin names [33m 3549[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects reserved plugin ids [33m 3354[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects packages without openclaw.extensions [33m 3207[2mms[22m[39m
 [32mâœ“[39m extensions/msteams/src/polls-store.test.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 133[2mms[22m[39m
 [32mâœ“[39m extensions/matrix/src/matrix/format.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 136[2mms[22m[39m
 [32mâœ“[39m extensions/diagnostics-otel/src/service.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 147[2mms[22m[39m
 [32mâœ“[39m extensions/twitch/src/token.test.ts [2m([22m[2m9 tests[22m[2m)[22m[32m 113[2mms[22m[39m
 [32mâœ“[39m extensions/nostr/src/nostr-state-store.test.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 185[2mms[22m[39m
 [32mâœ“[39m extensions/twitch/src/status.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 156[2mms[22m[39m
 [32mâœ“[39m src/commands/onboard-non-interactive.token.test.ts [2m([22m[2m1 test[22m[2m)[22m[33m 25000[2mms[22m[39m
     [33m[2mâœ“[22m[39m writes token profile config and stores the token [33m 24996[2mms[22m[39m
 [32mâœ“[39m extensions/bluebubbles/src/targets.test.ts [2m([22m[2m24 tests[22m[2m)[22m[32m 101[2mms[22m[39m
 [32mâœ“[39m src/config/config.legacy-config-detection.accepts-imessage-dmpolicy.test.ts [2m([22m[2m23 tests[22m[2m)[22m[33m 28747[2mms[22m[39m
     [33m[2mâœ“[22m[39m accepts imessage.dmPolicy="open" with allowFrom "*" [33m 1316[2mms[22m[39m
     [33m[2mâœ“[22m[39m defaults imessage.dmPolicy to pairing when imessage section exists [33m 1559[2mms[22m[39m
     [33m[2mâœ“[22m[39m defaults imessage.groupPolicy to allowlist when imessage section exists [33m 1337[2mms[22m[39m
     [33m[2mâœ“[22m[39m defaults discord.groupPolicy to allowlist when discord section exists [33m 1204[2mms[22m[39m
     [33m[2mâœ“[22m[39m defaults slack.groupPolicy to allowlist when slack section exists [33m 1404[2mms[22m[39m
     [33m[2mâœ“[22m[39m defaults msteams.groupPolicy to allowlist when msteams section exists [33m 1369[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects unsafe executable config values [33m 1001[2mms[22m[39m
     [33m[2mâœ“[22m[39m accepts tools audio transcription without cli [33m 1053[2mms[22m[39m
     [33m[2mâœ“[22m[39m accepts path-like executable values with spaces [33m 1288[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects discord.dm.policy="open" without allowFrom "*" [33m 1351[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects slack.dm.policy="open" without allowFrom "*" [33m 1271[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects legacy agent.model string [33m 1572[2mms[22m[39m
     [33m[2mâœ“[22m[39m migrates telegram.requireMention to channels.telegram.groups.*.requireMention [33m 1516[2mms[22m[39m
     [33m[2mâœ“[22m[39m migrates messages.tts.enabled to messages.tts.auto [33m 1347[2mms[22m[39m
     [33m[2mâœ“[22m[39m migrates legacy model config to agent.models + model lists [33m 1069[2mms[22m[39m
     [33m[2mâœ“[22m[39m flags legacy config in snapshot [33m 1009[2mms[22m[39m
     [33m[2mâœ“[22m[39m does not auto-migrate claude-cli auth profile mode on load [33m 1345[2mms[22m[39m
     [33m[2mâœ“[22m[39m flags legacy provider sections in snapshot [33m 1130[2mms[22m[39m
     [33m[2mâœ“[22m[39m flags routing.allowFrom in snapshot [33m 1145[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects bindings[].match.provider on load [33m 1254[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects bindings[].match.accountID on load [33m 1213[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects session.sendPolicy.rules[].match.provider on load [33m 1030[2mms[22m[39m
     [33m[2mâœ“[22m[39m rejects messages.queue.byProvider on load [33m 963[2mms[22m[39m
 [32mâœ“[39m extensions/nostr/src/channel.test.ts [2m([22m[2m21 tests[22m[2m)[22m[32m 137[2mms[22m[39m
 [32mâœ“[39m extensions/msteams/src/channel.directory.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 50[2mms[22m[39m
[90mstdout[2m | src/hooks/bundled/session-memory/handler.test.ts[2m > [22m[2msession-memory hook[2m > [22m[2mcreates memory file with session content on /new command
[22m[39m[session-memory] Hook triggered for /new command

[90mstdout[2m | src/hooks/bundled/session-memory/handler.test.ts[2m > [22m[2msession-memory hook[2m > [22m[2mcreates memory file with session content on /new command
[22m[39m[session-memory] Current sessionId: test-123
[session-memory] Current sessionFile: /tmp/openclaw-session-memory-e1ctcO/sessions/test-session.jsonl
[session-memory] cfg present: [33mtrue[39m

â€‰ELIFECYCLEâ€‰ Test failed. See above for more details.
